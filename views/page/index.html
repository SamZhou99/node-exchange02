<!DOCTYPE html>
<html lang="{{lang.list[defLang].lang}}">

<head>
	{{include './_header.html'}}
	<style>
		.main-table-box5 {
			margin: 50px auto 0 auto;
			width: 1200px;
			overflow: hidden;
			color: #ffffff;
			border: solid 1px #1f2636;
			background-color: #1f2636;
		}

		.main-table-box5 .table-tab {
			margin-bottom: 2px;
			height: 56px;
			line-height: 56px;
			border-bottom: solid 1px #313a56;
		}

		.main-table-box5 .table-tab li {
			float: left;
			margin: 0 10px;
			padding: 0 20px;
			font-size: 16px;
			cursor: pointer;
		}

		.main-table-box5 .table-tab li.active {
			color: #424ec5;
			border-bottom: #424ec5 2px solid;
		}

		.main-table-box5 .table-head {
			height: 48px;
			line-height: 48px;
		}

		.main-table-box5 .table-head li {
			float: left;
			width: 14.28%;
			font-size: 15px;
			color: #add5d8;
		}

		.main-table-box5 .table-head li i {
			margin: auto 13px;
		}

		.main-table-box5 .table-item {
			overflow: hidden;
		}

		.main-table-box5 .table-item li {
			height: 60px;
			line-height: 60px;
			overflow: hidden;
			border-top: solid 1px #313a56;
			font-size: 14px;
		}

		.main-table-box5 .table-item li:hover {
			background-color: #171a25;
		}

		.main-table-box5 .table-item li i {
			margin: auto 13px;
		}

		.main-table-box5 .table-item dt,
		.main-table-box5 .table-item dd {
			width: 14.28%;
		}

		.main-table-box5 .table-item dt.market img {
			vertical-align: middle;
		}

		.main-table-box5 .table-item dt.market span {
			vertical-align: middle;
		}

		.main-table-box5 .table-item dt.market span:last-child {
			color: #add5d8;
		}

		.main-table-box5 .table-item dt.market span.coin_name {
			vertical-align: middle;
			margin-left: 8px;
			color: #add5d8;
		}

		.main-table-box5 .table-item dd span {
			display: inline-block;
			padding: 6px 0px 6px 5px;
			min-width: 85px;
			line-height: normal;
			overflow: hidden;
			color: #fff;
			font-size: 12px;
			text-align: right;
			border-radius: 5px;
			vertical-align: middle;
			margin-top: -5px;
		}

		.main-table-box5 .table-item dd span.btn-up {
			background: #f1280f;
		}

		.main-table-box5 .table-item dd span.btn-down {
			background: #3dc18e;
		}

		.main-table-box5 .table-item dd i.icon-up,
		.main-table-box5 .table-item dd i.icon-down {
			position: relative;
			float: right;
			width: 10px;
			height: 13px;
			margin-left: 5px;
			margin-right: 7px;
			margin-top: 1px;
		}

		.main-table-box5 .table-item dd i.icon-up {
			background: url(../ecshe_img/icon-up.png) no-repeat;
			background-size: 100% 100%;
			animation: 2s ease 0s normal none infinite running magic-arrow-up;
		}

		.main-table-box5 .table-item dd i.icon-down {
			background: url(../ecshe_img/icon-down.png) no-repeat;
			background-size: 100% 100%;
			animation: 2s ease 0s normal none infinite running magic-arrow-down;
		}

		@keyframes magic-arrow-up {
			0% {
				opacity: 0;
				top: 5px;
			}

			30% {
				opacity: 1
			}

			100% {
				opacity: 0;
				top: 0;
			}
		}

		@keyframes magic-arrow-down {
			0% {
				opacity: 0;
				top: -5px;
			}

			30% {
				opacity: 1
			}

			100% {
				opacity: 0;
				top: 5px;
			}
		}

		.main-table-box5 .table-item dt.deal {
			text-align: left;
			margin-top: 12px;
			line-height: 20px;
		}

		.main-table-box5 .table-item dt.deal div {
			margin-left: 26px;
		}

		.main-table-box5 .table-item dt.deal p:first-child {
			font-size: 14px;
			color: #add5d8;
		}

		.main-table-box5 .table-item dt.deal p:last-child {
			font-size: 12px;
			color: #add5d8;
		}





		.main-summary {
			margin: 0 auto;
			/* width: 1200px; */
			overflow: hidden;
			margin-top: 20px;
			border-radius: 8px;
			background-color: #1f2636
		}

		.main-summary .title {
			line-height: 28px;
			font-size: 28px;
			font-weight: 300;
			color: #ffffff;
			text-align: center;
			margin: 85px 0 72px 0;
		}

		.main-summary .summary-content {
			overflow: hidden;
			border-radius: 8px;
		}

		.main-summary .summary-content .item {
			float: left;
			width: 277px;
			text-align: center;
			background-color: #1f2636;

		}

		.main-summary .summary-content .item p {
			font-size: 14px;
			color: #ffffff;
			line-height: 30px;
		}

		.main-summary .summary-content .item h3 {
			color: #add5d8;
			margin: 30px 0 22px 0;
			font-size: 20px;
			font-weight: 300;
		}





		.box-main-warings {
			margin: 0 auto;
			/* width: 1200px; */
			overflow: hidden;
			margin-top: 23px;
			margin-bottom: 38px;
			background-color: #1f2636;
			border-radius: 8px;
		}

		.box-main-warings .main-warings {
			margin: 0 auto;
			width: 620px;
			line-height: 50px;
			text-align: center;
		}

		.box-main-warings .main-warings img {

			vertical-align: middle;
		}

		.box-main-warings .main-warings span {
			vertical-align: middle;
			margin-left: 5px;
			font-size: 18px;
			color: #ffffff;
		}




		.table {
			font-size: small;
			color: #313a56;
			background-color: #ffffff;
		}

		.chang24hr-bg {
			border-radius: 5px;
			padding: 5px;
			text-align: center;
		}

		.zhang {
			background: #d4f6f0;
			color: #0d8551;
		}

		.die {
			color: #ef4034;
			background: #ffe4e4;
		}

		.ping {
			color: #6b6b6b;
			background: #ffffff;
		}

		@keyframes donghua-red {

			0%,
			100% {
				background: #ffffff00;
			}

			40%,
			60% {
				background: #d4f6f0;
			}
		}

		@-webkit-keyframes donghua-red {

			0%,
			100% {
				background: #ffffff00;
			}

			40%,
			60% {
				background: #d4f6f0;
			}
		}

		@keyframes donghua-green {

			0%,
			100% {
				background: #ffffff00;
			}

			40%,
			60% {
				background: #ffe4e4;
			}
		}

		@-webkit-keyframes donghua-green {

			0%,
			100% {
				background: #ffffff00;
			}

			40%,
			60% {
				background: #ffe4e4;
			}
		}

		.donghuaRed {
			animation: donghua-red 1s;
			-moz-animation: donghua-red 1s;
			-webkit-animation: donghua-red 1s;
			-o-animation: donghua-red 1s;
		}

		.donghuaGreen {
			animation: donghua-green 1s;
			-moz-animation: donghua-green 1s;
			-webkit-animation: donghua-green 1s;
			-o-animation: donghua-green 1s;
		}
	</style>
</head>

<body>
	{{include './_menu.html'}}

	{{include './_banner.html'}}


	<div class="container-fluid main-content" style="padding-top:0px;">

		{{include './_notice.html'}}

		<div id="app" class="container">

			<div class="table-responsive">
				<table class="table shadow p-3 mb-5 bg-dark text-white rounded">
					<thead class="thead-dark">
						<tr>
							<!-- <th scope="col">Rank</th> -->
							<th scope="col">Currency</th>
							<th scope="col">Last Price</th>
							<th scope="col">Market Value</th>
							<th scope="col">Supply(24Hr)</th>
							<th scope="col">Value(24Hr)</th>
							<th scope="col">Change(24Hr)</th>
						</tr>
					</thead>
					<tbody>
						<tr v-for="item in this.list" :id="item.node.id">
							<!-- <th scope="row">{[item.node.rank]}</th> -->
							<td>
								<div class="row">
									<div class="col-3"><img :src="item.node.logo" :alt="item.node.name" width="36px">
									</div>
									<div class="col-auto">
										<div>{[item.node.name]}</div>
										<div>{[item.node.symbol]}</div>
									</div>
								</div>
							</td>
							<td>{[item.node.priceUsd]}</td>
							<td>{[item.node.marketCapUsd]}</td>
							<td>{[item.node.supply]}</td>
							<td>{[item.node.volumeUsd24Hr]}</td>
							<td>
								<div v-if="item.node.changePercent24Hr>0" class="chang24hr-bg zhang">
									{[item.node.changePercent24Hr]}% ↑</div>
								<div v-if="item.node.changePercent24Hr==0" class="chang24hr-bg ping">
									{[item.node.changePercent24Hr]}%</div>
								<div v-if="item.node.changePercent24Hr<0" class="chang24hr-bg die">
									{[item.node.changePercent24Hr]}% ↓</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>

		</div>





		<div class="container">
			<div class="main-summary">
				<h2 class="title">{{lang.list[defLang].body.t1}}</h2>
				<div class="summary-content">
					<div class="item">
						<img src="/images/img_icon/trait_001.gif" />
						<h3>{{lang.list[defLang].body.t2}}</h3>
						<p>{{lang.list[defLang].body.t3}}</p>
						<p>{{lang.list[defLang].body.t4}}</p>
					</div>
					<div class="item">
						<img src="/images/img_icon/trait_002.gif" />
						<h3>{{lang.list[defLang].body.t5}}</h3>
						<p>{{lang.list[defLang].body.t6}}</p>
						<p>{{lang.list[defLang].body.t7}}</p>
					</div>
					<div class="item">
						<img src="/images/img_icon/trait_003.gif" />
						<h3>{{lang.list[defLang].body.t8}}</h3>
						<p>{{lang.list[defLang].body.t9}}</p>
						<p>{{lang.list[defLang].body.t10}}</p>
					</div>
					<div class="item">
						<img src="/images/img_icon/trait_004.gif" />
						<h3>{{lang.list[defLang].body.t11}}</h3>
						<p>{{lang.list[defLang].body.t12}}</p>
						<p>{{lang.list[defLang].body.t13}}</p>
					</div>
				</div>
			</div>

			<div class="box-main-warings">
				<div class="main-warings">
					<img src="/images/icon_waring.png" />
					<span>{{lang.list[defLang].body.t14}}</span>
				</div>
			</div>

			<div class="main-download" style="display:none">
				<div class="title">
					<h2>多终端覆盖</h2>
					<h3>支持IOS、ANDROID、WINDOWS、MAC等客户端全业务功能</h3>
				</div>
				<div class="listshow">
					<div class="list-ld">
						<img src="#/images/download-1.png" height="120" />
						<ul>
							<li><a onclick="Downloads()">MAC 下载</a></li>
							<li><a onclick="Downloads()">Win32位 下载</a></li>
							<li><a onclick="Downloads()">Win64位 下载</a></li>
						</ul>
					</div>
					<div class="list-rd">
						<img src="#/images/download-2.png" height="120" />
						<ul>
							<li><a onclick="Downloads()">IOS 下载</a></li>
							<li><a onclick="Downloads()">Android 下载</a></li>
						</ul>
					</div>
				</div>
			</div>

		</div>



	</div>



	{{include './_footer.html'}}

	<script>
		let app = new Vue({
			delimiters: ["{[", "]}"],
			el: '#app',
			data: {
				loading: false,
				list: [],
				statup: {}
			},
			methods: {
				round(num, intLen = 2, dotLaterLen = 6) {
					let z = '000000000000000000000000000000'
					let zn = Number(1 + z.substr(0, dotLaterLen))
					num = Math.round(num * zn) / zn
					let s = String(num)

					if (s.indexOf('.') !== -1) {
						let a = s.split('.')
						let n1 = a[0], n2 = a[1], zn

						if (a[0].length < intLen) {
							n1 = z.substr(0, intLen - a[0].length) + a[0]
						}

						if (a[1].length < dotLaterLen) {
							zn = z.substr(0, dotLaterLen - a[1].length)
							n2 = String(a[1]) + zn
						}

						let res = `${n1}.${n2}`
						return res
					}

					let zl = z.substr(0, dotLaterLen)
					return `${s}.${zl}`
				},
				lessen(num, min, len) {
					let n = num / min
					return this.round(n, len)
				},
				moneyFormat(num) {
					return num.toLocaleString('en', {
						style: 'currency',
						currency: 'USD',
						minimumFractionDigits: 0
					})
				},
				get(url, params, callback) {
					this.loading = true;
					$.ajax({
						'url': url,
						'type': 'GET',
						'dataType': 'json',
						'data': params,
						'success': res => {
							this.loading = false;
							callback(res);
						},
						'error': err => {
							this.loading = false;
							console.log(err);
							alert(err.statusText);
						}
					})
				},
				coinList(data) {
					let _t = this
					let a = data
					a.forEach(function (item) {
						item.node = {}
						item.node.id = item.name.toLocaleLowerCase()
						item.node.name = item.name
						item.node.symbol = item.symbol
						item.node.logo = `https://assets.coincap.io/assets/icons/${item.symbol.toLocaleLowerCase()}@2x.png`
						item.node.priceUsd = _t.round(item.priceUsd, 1)
						item.node.marketCapUsd = _t.round(item.marketCapUsd, 12, 2)
						item.node.supply = _t.round(item.supply, 6, 2)
						item.node.volumeUsd24Hr = _t.lessen(item.volumeUsd24Hr, 9, 2)
						item.node.changePercent24Hr = _t.round(item.changePercent24Hr, 2, 2)
					})

					let ptb = {
						node: {
							id: _t.statup.name.toLocaleLowerCase(),
							name: _t.statup.name,
							symbol: _t.statup.symbol,
							logo: _t.statup.icon,
							priceUsd: _t.round(0, 1),
							marketCapUsd: _t.round(78623827.73 - Math.random() * 10000, 12, 2),
							supply: _t.round(3148153.73 - Math.random() * 1000, 6, 2),
							volumeUsd24Hr: _t.lessen(1143447.01 - Math.random() * 1000, 9, 2),
							changePercent24Hr: _t.round(0, 2, 2),
							rank: this.statup.sort,
						}
					}
					if (this.statup.sort == 0 || this.statup.sort > a.length) {
						a.push(ptb)
					} else {
						a.splice(this.statup.sort - 1, 0, ptb)
					}
					this.list = a
				},
				initWS() {
					let ws = new WebSocket('{{lang.ws}}/coin/price')
					ws.onopen = () => {
						console.log('websocket init ...')
					};
					ws.onclose = () => {
						console.log('websocket close ...')

						setTimeout(() => {
							this.initWS()
						}, 60000)
					}
					ws.onmessage = (event) => {
						const time = 1000
						let _t = this
						let res = JSON.parse(event.data)
						this.list.forEach(function (item) {
							let key = item.node.id
							if (key == _t.statup.name.toLocaleLowerCase() && Math.random() * 5 > 2) {
								let v = res.platform.price
								let className = Number(item.node.priceUsd) > v ? 'donghuaGreen' : 'donghuaRed'
								item.node.priceUsd = _t.round(v, 1, 6)
								item.node.changePercent24Hr = _t.round(res.platform.price_percent * res.platform.ts_percent, 1, 2)
								// $('#' + key).addClass(className)
								// setTimeout(() => {
								// 	$('#' + key).removeClass(className)
								// }, time)
							}
							let v = res.cache[key]
							if (v) {
								let className = Number(item.node.priceUsd) > v ? 'donghuaGreen' : 'donghuaRed'
								item.node.priceUsd = _t.round(v, 1, 6)
								// $('#' + key).addClass(className)
								// setTimeout(() => {
								// 	$('#' + key).removeClass(className)
								// }, time)
							}
						})
					}
				},
				getList() {
					this.get('/api/coincap-coin-list/caches', {}, (data) => {
						this.coinList(data.data.value)
						this.initWS()
					})
				},
				init() {
					this.get('/api/startup', {}, (data) => {
						this.statup = data.data.currency
						this.getList()
					})
				}
			},
			mounted() {
				this.init();
			}
		});
	</script>

</body>

</html>